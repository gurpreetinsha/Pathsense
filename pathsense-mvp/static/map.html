<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PathSense Multi-Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <style>
    body { margin:0; font-family: 'Inter', sans-serif; background:#f8f9fa; }
    .maps-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      height: 100vh;
    }
    .map {
      position: relative;
      width: 100%;
      height: 100%;
      border: 1px solid #ddd;
    }
    .map h3 {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(255,255,255,0.8);
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 14px;
      z-index: 500;
    }
  </style>
</head>
<body>
  <div class="maps-container">
    <div id="map1" class="map"><h3>General Route</h3></div>
    <div id="map2" class="map"><h3>Disruptions</h3></div>
    <div id="map3" class="map"><h3>Vehicle Routes</h3></div>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // Common settings
    const center = [28.61, 77.20];
    const zoomLevel = 12;

    // Map 1: General Route
    const map1 = L.map("map1").setView(center, zoomLevel);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "© OpenStreetMap contributors"
    }).addTo(map1);

    // Map 2: Disruption Hazards
    const map2 = L.map("map2").setView(center, zoomLevel);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "© OpenStreetMap contributors"
    }).addTo(map2);

    const severityColors = {
      1: "#2ecc71",
      2: "#f1c40f",
      3: "#e67e22",
      4: "#e74c3c",
      5: "#8e44ad"
    };

    async function loadHazards() {
      const res = await fetch("/list");
      const hazards = await res.json();
      hazards.forEach(h => {
        const color = severityColors[h.severity] || "#3498db";
        L.circleMarker([h.lat, h.lon], {
          radius: 8 + h.severity * 2,
          color: color,
          fillColor: color,
          fillOpacity: 0.6,
          weight: 1
        }).bindPopup(`<b>${h.description}</b><br>Severity: ${h.severity}`)
          .addTo(map2);
      });
    }
    loadHazards();

    // Map 3: Vehicle-specific Routes
    const map3 = L.map("map3").setView(center, zoomLevel);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "© OpenStreetMap contributors"
    }).addTo(map3);

    // Example vehicle routes (mocked demo lines)
    const bikeRoute = L.polyline([[28.61, 77.20],[28.62,77.21],[28.63,77.22]], {color:"green"}).addTo(map3).bindPopup("Bike Friendly");
    const carRoute = L.polyline([[28.61, 77.20],[28.60,77.22],[28.59,77.24]], {color:"blue"}).addTo(map3).bindPopup("Car Allowed");
    const truckRoute = L.polyline([[28.61, 77.20],[28.62,77.18],[28.63,77.16]], {color:"red"}).addTo(map3).bindPopup("Truck Route");

  </script>
</body>
</html>
